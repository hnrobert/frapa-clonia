<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:FrapaClonia.UI.ViewModels;assembly=FrapaClonia.UI"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="700" d:DesignHeight="600"
             x:Class="FrapaClonia.UI.Views.SettingsView"
             x:DataType="vm:SettingsViewModel">

    <Design.DataContext>
        <vm:SettingsViewModel />
    </Design.DataContext>

    <UserControl.Styles>
        <!-- Settings dropdown -->
        <Style Selector="ComboBox.settings-dropdown">
            <Setter Property="MinWidth" Value="240" />
            <Setter Property="HorizontalAlignment" Value="Left" />
        </Style>

        <!-- Settings checkbox -->
        <Style Selector="CheckBox.settings-checkbox">
            <Setter Property="Margin" Value="{StaticResource ThicknessTopS}" />
        </Style>

        <Style Selector="CheckBox.settings-checkbox > ContentPresenter">
            <Setter Property="Margin" Value="{StaticResource ThicknessLeftS}" />
        </Style>

        <!-- Readonly value -->
        <Style Selector="TextBlock.readonly-value">
            <Setter Property="FontSize" Value="{StaticResource FontSizeM}" />
            <Setter Property="FontFamily" Value="{DynamicResource MonoFontFamily}" />
            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseMediumBrush}" />
            <Setter Property="TextWrapping" Value="Wrap" />
        </Style>

        <!-- Primary action button -->
        <Style Selector="Button.action-button.primary">
            <Setter Property="Background" Value="{DynamicResource SystemAccentColor1Brush}" />
            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundAltHighBrush}" />
            <Setter Property="FontWeight" Value="{StaticResource FontWeightSemiBold}" />
        </Style>

        <Style Selector="Button.action-button.primary:pointerover">
            <Setter Property="Background" Value="{DynamicResource SystemAccentColor2Brush}" />
        </Style>
    </UserControl.Styles>

    <ScrollViewer HorizontalScrollBarVisibility="Disabled">
        <Panel Margin="{StaticResource ContentPadding}">
            <StackPanel Spacing="{StaticResource SpacingL}" MaxWidth="650">
                <!-- Header -->
                <TextBlock Text="Settings"
                           FontSize="{StaticResource FontSizeXXXL}"
                           FontWeight="{StaticResource FontWeightSemiBold}"
                           Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}" />

                <!-- Language Settings -->
                <Border Classes="settings-card">
                    <StackPanel Spacing="0">
                        <TextBlock Text="Language &amp; Region"
                                   Classes="section-title"
                                   Margin="{StaticResource ThicknessBottomM}" />

                        <Grid ColumnDefinitions="180,*" RowDefinitions="Auto,Auto">
                            <TextBlock Grid.Row="0" Grid.Column="0"
                                       Text="Interface Language"
                                       Classes="field-label" />
                            <ComboBox Grid.Row="0" Grid.Column="1"
                                      ItemsSource="{Binding AvailableLanguages}"
                                      SelectedItem="{Binding SelectedLanguage}"
                                      Classes="settings-dropdown"
                                      AutomationProperties.Name="Interface Language">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Name}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            <TextBlock Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                                       Text="Changes will take effect after restarting the application"
                                       Classes="hint" />
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Startup Settings -->
                <Border Classes="settings-card">
                    <StackPanel Spacing="0">
                        <TextBlock Text="System Integration"
                                   Classes="section-title"
                                   Margin="{StaticResource ThicknessBottomM}" />

                        <CheckBox IsChecked="{Binding AutoStartEnabled}"
                                  Classes="settings-checkbox"
                                  AutomationProperties.Name="Start on system boot">
                            <StackPanel Spacing="{StaticResource SpacingS}">
                                <TextBlock Text="Start on system boot"
                                           FontSize="{StaticResource FontSizeM}"
                                           FontWeight="{StaticResource FontWeightMedium}" />
                                <TextBlock Text="Automatically launch FrapaClonia when you sign in"
                                           Classes="hint" />
                            </StackPanel>
                        </CheckBox>
                    </StackPanel>
                </Border>

                <!-- Appearance Settings -->
                <Border Classes="settings-card">
                    <StackPanel Spacing="0">
                        <TextBlock Text="Appearance"
                                   Classes="section-title"
                                   Margin="{StaticResource ThicknessBottomM}" />

                        <Grid ColumnDefinitions="180,*" RowDefinitions="Auto,Auto">
                            <TextBlock Grid.Row="0" Grid.Column="0"
                                       Text="Theme"
                                       Classes="field-label" />
                            <ComboBox Grid.Row="0" Grid.Column="1"
                                      Classes="settings-dropdown"
                                      SelectedIndex="{Binding ThemeIndex}">
                                <ComboBoxItem>Light</ComboBoxItem>
                                <ComboBoxItem>Dark</ComboBoxItem>
                                <ComboBoxItem>System Default</ComboBoxItem>
                            </ComboBox>
                            <TextBlock Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                                       Text="Choose your preferred color theme"
                                       Classes="hint" />
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Application Mode -->
                <Border Classes="settings-card">
                    <StackPanel Spacing="0">
                        <TextBlock Text="Application Mode"
                                   Classes="section-title"
                                   Margin="{StaticResource ThicknessBottomM}" />

                        <CheckBox IsChecked="{Binding PortableMode}"
                                  IsEnabled="False"
                                  Classes="settings-checkbox"
                                  AutomationProperties.Name="Portable Mode">
                            <StackPanel Spacing="{StaticResource SpacingS}">
                                <TextBlock Text="Portable Mode"
                                           FontSize="{StaticResource FontSizeM}"
                                           FontWeight="{StaticResource FontWeightMedium}" />
                                <TextBlock Text="Configuration stored in application directory (requires portable.txt)"
                                           Classes="hint" />
                            </StackPanel>
                        </CheckBox>

                        <Border BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                                BorderThickness="0,1,0,0"
                                Margin="{StaticResource ThicknessTopL}"
                                Padding="{StaticResource ThicknessTopL}">
                            <StackPanel Spacing="0">
                                <TextBlock Text="Configuration Location"
                                           Classes="field-label" />
                                <TextBlock Text="{Binding ConfigLocation}"
                                           Classes="readonly-value"
                                           AutomationProperties.Name="Configuration Location" />
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- About Information -->
                <Border Classes="settings-card">
                    <StackPanel Spacing="0">
                        <TextBlock Text="About"
                                   Classes="section-title"
                                   Margin="{StaticResource ThicknessBottomM}" />

                        <Grid ColumnDefinitions="120,Auto" RowDefinitions="Auto,Auto,Auto,Auto">
                            <TextBlock Grid.Row="0" Grid.Column="0"
                                       Text="Version"
                                       Classes="field-label" />
                            <TextBlock Grid.Row="0" Grid.Column="1"
                                       Text="0.1.0"
                                       VerticalAlignment="Center" />

                            <TextBlock Grid.Row="1" Grid.Column="0"
                                       Text="Build"
                                       Classes="field-label" />
                            <TextBlock Grid.Row="1" Grid.Column="1"
                                       Text="Development"
                                       VerticalAlignment="Center" />

                            <TextBlock Grid.Row="2" Grid.Column="0"
                                       Text=".NET Runtime"
                                       Classes="field-label" />
                            <TextBlock Grid.Row="2" Grid.Column="1"
                                       Text="10.0"
                                       VerticalAlignment="Center" />

                            <TextBlock Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2"
                                       Text="A cross-platform frpc visual client built with Avalonia UI"
                                       Classes="hint"
                                       Margin="{StaticResource ThicknessTopM}" />
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Action Buttons -->
                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Right"
                            Spacing="{StaticResource SpacingM}"
                            Margin="{StaticResource ThicknessTopS}">
                    <Button Command="{Binding ResetCommand}"
                            Content="Reset to Defaults"
                            Classes="action-button"
                            IsEnabled="{Binding !IsSaving}"
                            AutomationProperties.Name="Reset to Defaults" />

                    <Button Command="{Binding SaveCommand}"
                            Classes="action-button primary"
                            IsEnabled="{Binding !IsSaving}"
                            AutomationProperties.Name="Save Settings">
                        <StackPanel Orientation="Horizontal" Spacing="{StaticResource SpacingS}">
                            <TextBlock Text="Save Settings" />
                            <ProgressBar IsIndeterminate="True"
                                         Width="16"
                                         Height="16"
                                         IsVisible="{Binding IsSaving}" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </StackPanel>
        </Panel>
    </ScrollViewer>
</UserControl>